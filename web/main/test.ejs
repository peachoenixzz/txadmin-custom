<%- await include('parts/header.ejs', locals) %>
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.5/css/jquery.dataTables.css" />

<div class="text-center">
    <h3>Player Log</h3>
  </div>
  <hr>
<div >
  <div class="d-flex justify-content-center" style="margin-bottom: 15px">
    <div class="search-container">
      <input id="search-event" type="text" class="form-control" placeholder="Search">
    </div>
      <div class="search-container">
      <input id="search-player" type="text" class="form-control" placeholder="Search">
    </div>
      <div class="search-container">
      <input id="search-date" type="text" class="form-control" placeholder="Search">
    </div>
    <div class="search-container">
        <input id="search-event" type="text" class="form-control" placeholder="Search">
      </div>
      <div class="search-container">
        <input id="search-event" type="text" class="form-control" placeholder="Search">
      </div>
 </div>

<table id="myTable" class="table table-striped">
    <thead>
        <tr>
            <th>Event Name</th>
            <th>Discord ID</th>
        </tr>
    </thead>
    <tbody id="data-body">
    </tbody>
</table>

<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>
    // const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
    const api = 'https://circleproject.dev/api/fivemlog';

    const headers = {
      // 'Host': 'https://circleproject.dev',
      // 'Origin': 'https://tx.circleproject.dev',
      'Access-Control-Allow-Origin': 'https://tx.circleproject.dev',
      // 'Access-Control-Request-Method' : 'GET',
      // 'Access-Control-Request-Headers': 'Authorization',
      // 'Referer': 'https://tx.circleproject.dev',
      'Authorization': 'Basic dGhlY2lyY2xlZGV2OlRoZWNpcmNsZTExMiFAIw=='
    }

    axios.get(api, {
      headers:headers
    })
            .then(function (response) {
              const data = response.data;
              const dataBody = document.getElementById('data-body');
               dataBody.innerHTML = '';

               data.forEach(function (item) {
               const row = document.createElement('tr');

               const eventNameCell = document.createElement('td');
               eventNameCell.textContent = item.content;
               row.appendChild(eventNameCell);

               const discordCell = document.createElement('td');
               discordCell.textContent = item.player.identifiers.discord;
               row.appendChild(discordCell);


               dataBody.appendChild(row);
    });
            })
            .catch(function (error) {
              console.log(error);
            });
  </script>

<%- await include('parts/footer.ejs', locals) %>

<script src="https://cdn.datatables.net/1.13.5/js/jquery.dataTables.js"></script>
<script>
    $(document).ready( function () {
    $('#myTable').DataTable();
} );
</script>